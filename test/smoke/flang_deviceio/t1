commit 2e784755ad5a3008575437ee80fb3f66fa694e02
Author: Ron Lieberman <Ron.Lieberman@amd.com>
Date:   Fri Feb 26 19:52:11 2021 -0500

    Add fortran deviceio test

diff --git a/test/smoke/Makefile b/test/smoke/Makefile
index e6e7151..322d829 100644
--- a/test/smoke/Makefile
+++ b/test/smoke/Makefile
@@ -25,6 +25,7 @@ TESTS_DIR = \
     flang_2regions \
     flang_blkdata-g \
     flang_char_kind \
+    flang_deviceio \
     flang_gen_sptr_prob \
     flang_isystem_prob \
     flang_klemm_map \
diff --git a/test/smoke/flang_deviceio/Makefile b/test/smoke/flang_deviceio/Makefile
new file mode 100644
index 0000000..1e01eb8
--- /dev/null
+++ b/test/smoke/flang_deviceio/Makefile
@@ -0,0 +1,16 @@
+include ../Makefile.defs
+
+TESTNAME     = flang_deviceio
+TESTSRC_MAIN = flang_deviceio.f90
+TESTSRC_AUX  =
+TESTSRC_ALL  = $(TESTSRC_MAIN) $(TESTSRC_AUX)
+
+TARGET       = -fopenmp -O3 -w -i8 -fopenmp-targets=amdgcn-amd-amdhsa -Xopenmp-target=amdgcn-amd-amdhsa -march=$(AOMP_GPU)
+
+FLANG        = flang
+OMP_BIN      = $(AOMP)/bin/$(FLANG)
+CC           = $(OMP_BIN) $(VERBOSE)
+#-ccc-print-phases
+#"-\#\#\#"
+
+include ../Makefile.rules
diff --git a/test/smoke/flang_deviceio/flang_deviceio.f90 b/test/smoke/flang_deviceio/flang_deviceio.f90
new file mode 100644
index 0000000..c5e1a5c
--- /dev/null
+++ b/test/smoke/flang_deviceio/flang_deviceio.f90
@@ -0,0 +1,38 @@
+module f90deviceio
+  interface
+    subroutine f90print(N)
+      character(*) :: N
+      !$omp declare target (f90print)
+    end subroutine f90print
+    subroutine f90printi(N,i)
+      character(*) :: N
+      integer :: i
+      !$omp declare target (f90printi)
+    end subroutine f90printi
+    subroutine f90printf(N,f)
+      character(*) :: N
+      real(4) :: f
+      !$omp declare target (f90printf)
+    end subroutine f90printf
+    subroutine f90printd(N,d)
+      character(*) :: N
+      real(8) :: d
+      !$omp declare target (f90printd)
+    end subroutine f90printd
+  end interface
+end module
+program ftest
+     use omp_lib
+     use f90deviceio
+
+     !$omp target
+     if (omp_get_thread_num() .eq. 2) then
+       call f90print("Hello from gpu")
+       call f90printi("Hello from gpu",2)
+       call f90printf("Hello from gpu", 3.0)
+       call f90printd("Hello from gpu", 4.0D0)
+     endif
+     !$omp end target
+
+end program ftest
+
